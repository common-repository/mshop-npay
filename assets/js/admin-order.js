jQuery(function(o){o.blockUI.defaults.css.border="none",o.blockUI.defaults.css.width="32px",o.blockUI.defaults.css.height="32px",o.blockUI.defaults.css.background="transparent",o.blockUI.defaults.overlayCSS.opacity=.3;var n=o("#naverpay_order_action");function r(e,r){n.block({message:null}),o.ajax({type:"post",dataType:"json",url:naverpay_admin_order.ajax_url,data:{action:e,param:r},success:function(e){n.unblock(),e.success?window.location.reload():alert(e.data)},error:function(e){n.unblock()}})}n.find(".DelayProductOrder .button-search").on("click",function(){var e=n.find(".DelayProductOrder");r("naverpay_delay_product_order",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,DispatchDueDate:e.find(".DispatchDueDate").val()+"T00:00:00+09:00",DispatchDelayReasonCode:e.find("select.DispatchDelayReasonCode").val(),DispatchDelayDetailReason:e.find(".DispatchDelayDetailReason").val()})}),n.find(".ShipProductOrder .button-search").on("click",function(){var e=n.find(".ShipProductOrder");r("naverpay_ship_product_order",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,DeliveryMethodCode:e.find("select.DeliveryMethodCode").val(),DeliveryCompanyCode:e.find("select.DeliveryCompanyCode").val(),TrackingNumber:e.find(".TrackingNumber").val(),DispatchDate:e.find(".DispatchDate").val()+"T00:00:00+09:00"})}),n.find(".ReturnInfo .ApproveReturn").on("click",function(){n.find(".ReturnInfo");r("naverpay_approve_return_application",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".ReturnInfo .RejectReturn").on("click",function(){var e=n.find(".ReturnInfo");r("naverpay_reject_return",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,RejectDetailContent:e.find(".RejectDetailContent").val()})}),n.find(".ReturnInfo .WithholdReturn").on("click",function(){var e=n.find(".ReturnInfo");r("naverpay_withhold_return",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,ReturnHoldCode:e.find("select.ReturnHoldCode").val(),ReturnHoldDetailContent:e.find(".ReturnHoldDetailContent").val(),EtcFeeDemandAmount:e.find(".EtcFeeDemandAmount").val()})}),n.find(".ReturnInfo .ReleaseReturnHold").on("click",function(){r("naverpay_release_return_hold",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".ExchangeInfo .ApproveExchange").on("click",function(){n.find(".ExchangeInfo");r("naverpay_approve_exchange_application",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".ExchangeInfo .ApproveCollectedExchange").on("click",function(){n.find(".ExchangeInfo");r("naverpay_approve_collected_exchange",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".ExchangeInfo .RejectExchange").on("click",function(){var e=n.find(".ExchangeInfo");r("naverpay_reject_exchange",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,RejectDetailContent:e.find(".RejectDetailContent").val()})}),n.find(".ExchangeInfo .WithholdExchange").on("click",function(){var e=n.find(".ExchangeInfo");r("naverpay_withhold_exchange",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,ExchangeHoldCode:e.find("select.ExchangeHoldCode").val(),ExchangeHoldDetailContent:e.find(".ExchangeHoldDetailContent").val(),EtcFeeDemandAmount:e.find(".EtcFeeDemandAmount").val()})}),n.find(".ExchangeInfo .ReleaseExchangeHold").on("click",function(){r("naverpay_release_exchange_hold",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".ExchangeInfo .ReDeliveryExchange").on("click",function(){var e=n.find(".ExchangeInfo");r("naverpay_redelivery_exchange",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,ReDeliveryMethodCode:e.find("select.ReDeliveryMethodCode").val(),ReDeliveryCompanyCode:e.find("select.ReDeliveryCompanyCode").val(),ReDeliveryTrackingNumber:e.find(".ReDeliveryTrackingNumber").val()})}),n.find(".PlaceProductOrder .PlaceProductOrder").on("click",function(){r(naverpay_admin_order.slug+"-place_product_order",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".CancelInfo .ApproveCancel").on("click",function(){r("naverpay_approve_cancel_application",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id})}),n.find(".CancelSale .CancelSale").on("click",function(){var e=n.find(".CancelSale");r("naverpay_cancel_sale",{OrderID:naverpay_admin_order.order_id,ProductOrderID:naverpay_admin_order.product_order_id,CancelReasonCode:e.find("select.CancelReasonCode").val()})})}),jQuery(function(a){var n={init:function(){a("#mnp-naverpay-order").find(".datepicker").datepicker({dateFormat:"yy-mm-dd"}).datepicker("setDate",new Date),a("#mnp-naverpay-order").on("click","button.refresh-npay-order",this.refresh_npay_order).on("click","button.place-order-items",this.show_action_panel).on("click","button.delay-product-order-items",this.show_action_panel).on("click","button.cancel-sale-items",this.show_action_panel).on("click","button.ship-product-order-items",this.show_action_panel).on("click","button.return-items",this.show_action_panel).on("click","button.approve-cancel-application-items",this.show_action_panel).on("click","button.approve-return-application-items",this.show_action_panel).on("click","button.withhold-return-items",this.show_action_panel).on("click","button.release-return-hold-items",this.show_action_panel).on("click","button.request-return-items",this.show_action_panel).on("click","button.reject-return-items",this.show_action_panel).on("click","button.approve-collected-exchange-items",this.show_action_panel).on("click","button.withhold-exchange-items",this.show_action_panel).on("click","button.release-exchange-hold-items",this.show_action_panel).on("click","button.reject-exchange-items",this.show_action_panel).on("click","button.redelivery-exchange-items",this.show_action_panel).on("click","button.do-place-product-order",this.bulk_actions.place_product_order).on("click","button.do-delay-product-order",this.bulk_actions.delay_product_order).on("click","button.do-ship-product-order",this.bulk_actions.ship_product_order).on("click","button.do-approve-return",this.bulk_actions.approve_return).on("click","button.do-withhold-return",this.bulk_actions.withhold_return).on("click","button.do-release-return-hold",this.bulk_actions.release_return_hold).on("click","button.do-request-return",this.bulk_actions.request_return).on("click","button.do-reject-return",this.bulk_actions.reject_return).on("click","button.do-approve-cancel-application",this.bulk_actions.approve_cancel_application).on("click","button.do-approve-collected-exchange",this.bulk_actions.approve_collected_exchange).on("click","button.do-withhold-exchange",this.bulk_actions.withhold_exchange).on("click","button.do-release-exchange-hold",this.bulk_actions.release_exchange_hold).on("click","button.do-reject-exchange",this.bulk_actions.reject_exchange).on("click","button.do-redelivery-exchange",this.bulk_actions.redelivery_exchange).on("click","button.do-cancel-sale",this.bulk_actions.cancel_sale).on("click","input.check-column",this.bulk_actions.check_column).on("click","td.check-column input",this.update_action_button).on("click",".cancel-action",this.cancel),a("body").on("wc_backbone_modal_loaded",this.backbone.init).on("wc_backbone_modal_response",this.backbone.response)},refresh_npay_order:function(){return n.block(),a.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:naverpay_admin_order.slug+"-refresh_npay_order",order_id:naverpay_admin_order.order_id},success:function(e){e.success?window.location.reload():(alert(e.data),n.unblock())},error:function(e){n.unblock()}}),!1},update_action_button:function(){function e(r,e,o){null==o&&(o=function(e){return e.hasClass(r)}),0===n.length||n.length!==n.filter(o).length?(a("#mnp-naverpay-order button."+e).prop("disabled","disabled"),o=a("#mnp-naverpay-order button."+e).data("action-panel"),"block"==a("#mnp-naverpay-order div."+o).css("display")&&a("#mnp-naverpay-order div."+o+" button.cancel-action").trigger("click")):a("#mnp-naverpay-order button."+e).prop("disabled","")}var r=a("#mnp-naverpay-order").find(".check-column input:checked"),n=[];a(r).each(function(){n.push(a(this).closest("tr"))}),e("place-product-order","place-order-items"),e("delay-product-order","delay-product-order-items"),e("ship-product-order","ship-product-order-items"),e("approve-cancel-application","approve-cancel-application-items"),e("cancel-sale","cancel-sale-items"),e("approve-return-application","approve-return-application-items"),e("withhold-return","withhold-return-items"),e("request-return","request-return-items"),e("reject-return","reject-return-items"),e("release-return-hold","release-return-hold-items"),e("approve-collected-exchange","approve-collected-exchange-items"),e("withhold-exchange","withhold-exchange-items"),e("release-exchange-hold","release-exchange-hold-items"),e("reject-exchange","reject-exchange-items"),e("redelivery-exchange","redelivery-exchange-items")},block:function(){a("#mnp-naverpay-order .inside").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){a("#mnp-naverpay-order .inside").unblock()},reload_items:function(){var e={order_id:woocommerce_admin_meta_boxes.post_id,action:"woocommerce_load_order_items",security:woocommerce_admin_meta_boxes.order_item_nonce};wc_meta_boxes_order_items.block(),a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:e,type:"POST",success:function(e){a("#woocommerce-order-items .inside").empty(),a("#woocommerce-order-items .inside").append(e),wc_meta_boxes_order.init_tiptip(),wc_meta_boxes_order_items.unblock(),wc_meta_boxes_order_items.stupidtable.init()}})},show_action_panel:function(){var e=a(this).data("action-panel");return a("#mnp-naverpay-order div."+e).slideDown(),a("#mnp-naverpay-order div.mnp-order-bulk-actions").slideUp(),!1},place_order_items:function(){return a("#mnp-naverpay-order div.mnp-order-place-order-items").slideDown(),a("#mnp-naverpay-order div.mnp-order-bulk-actions").slideUp(),!1},delay_product_order_items:function(){return a("#mnp-naverpay-order div.mnp-order-delay-product-order-items").slideDown(),a("#mnp-naverpay-order div.mnp-order-bulk-actions").slideUp(),!1},cancel:function(){return a(this).closest("div.mnp-order-data-row").slideUp(),a("div.mnp-order-bulk-actions").slideDown(),"true"===a(this).attr("data-reload")&&wc_meta_boxes_order_items.reload_items(),!1},bulk_actions:{check_column:function(){a(this).is(":checked")?a("#mnp-naverpay-order").find(".check-column input").attr("checked","checked"):a("#mnp-naverpay-order").find(".check-column input").removeAttr("checked"),n.update_action_button()},do_naverpay_action:function(e,r,o){n.block(),a.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:e,params:r},success:function(e){e.success?(o&&alert(o),window.location.reload()):(alert(e.data),n.unblock())},error:function(e){n.unblock()}})},place_product_order:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"place_product_order",order_id:naverpay_admin_order.order_id,product_order_id:r.join(",")},"발주 처리가 되었습니다."),!1},delay_product_order:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"delay_product_order",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),dispatch_due_date:a(".mnp-order-delay-product-order-items .DispatchDueDate").val()+"T00:00:00+09:00",dispatch_delay_reason_code:a(".mnp-order-delay-product-order-items select.DispatchDelayReasonCode").val(),dispatch_delay_detail_reason:a(".mnp-order-delay-product-order-items .DispatchDelayDetailReason").val()},"발송지연 처리가 되었습니다."),!1},ship_product_order:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"ship_product_order",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),delivery_method_code:a(".mnp-order-ship-product-order-items select.DeliveryMethodCode").val(),delivery_company_code:a(".mnp-order-ship-product-order-items select.DeliveryCompanyCode").val(),tracking_number:a(".mnp-order-ship-product-order-items .TrackingNumber").val(),dispatch_date:a(".mnp-order-ship-product-order-items .DispatchDate").val()+"T00:00:00+09:00"},"배송 처리가 되었습니다."),!1},release_return_hold:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"release_return_hold",order_id:naverpay_admin_order.order_id,product_order_id:r.join(",")},"반품 보류가 해제되었습니다."),!1},approve_return:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"approve_return_application",order_id:naverpay_admin_order.order_id,product_order_id:r.join(",")},"반품요청이 승인되었습니다."),!1},request_return:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"request_return",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),return_reason_code:a(".mnp-order-request-return-items select.ReturnReasonCode").val(),collect_delivery_method_code:a(".mnp-order-request-return-items select.CollectDeliveryMethodCode").val(),collect_delivery_company_code:a(".mnp-order-request-return-items select.CollectDeliveryCompanyCode").val(),collect_tracking_number:a(".mnp-order-request-return-items .CollectTrackingNumber").val()},"반품 접수 처리가 되었습니다."),!1},withhold_return:function(){var e,r;if(""!=a(".mnp-order-withhold-return-items .ReturnHoldDetailContent").val())return e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[],a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"withhold_return",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),return_hold_code:a(".mnp-order-withhold-return-items select.ReturnHoldCode").val(),return_hold_detail_content:a(".mnp-order-withhold-return-items .ReturnHoldDetailContent").val(),etc_fee_demand_amount:a(".mnp-order-withhold-return-items .EtcFeeDemandAmount").val()},"반품요청이 보류되었습니다."),!1;alert("반품 보류 상세 사유를 입력해주세요.")},reject_return:function(){var e,r;if(""!=a(".mnp-order-reject-return-items .RejectDetailContent").val())return e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[],a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"reject_return",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),reject_detail_content:a(".mnp-order-reject-return-items .RejectDetailContent").val()},"반품요청이 거절되었습니다."),!1;alert("반품 거절 사유를 입력해주세요.")},cancel_sale:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"cancel_sale",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),cancel_reason_code:a(".mnp-order-cancel-sale-items select.CancelReasonCode").val()},"주문을 취소했습니다."),!1},approve_cancel_application:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"approve_cancel_application",order_id:naverpay_admin_order.order_id,product_order_id:r.join(",")},"취소요청을 승인하였습니다."),!1},approve_collected_exchange:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"approve_collected_exchange",order_id:naverpay_admin_order.order_id,product_order_id:r.join(",")},"교환을 수거 완료 처리 했습니다."),!1},withhold_exchange:function(){var e,r;if(""!=a(".mnp-order-withhold-exchange-items .ExchangeHoldDetailContent").val())return e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[],a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"withhold_exchange",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),exchange_hold_code:a(".mnp-order-withhold-exchange-items select.ExchangeHoldCode").val(),exchange_hold_detail_content:a(".mnp-order-withhold-exchange-items .ExchangeHoldDetailContent").val(),etc_fee_demand_amount:a(".mnp-order-withhold-exchange-items .EtcFeeDemandAmount").val()},"교환 처리를 보류했습니다."),!1;alert("교환 보류 상세 사유를 입력해주세요.")},release_exchange_hold:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"release_exchange_hold",order_id:naverpay_admin_order.order_id,product_order_id:r.join(",")},"교환 보류를 해제했습니다."),!1},reject_exchange:function(){var e,r;if(""!=a(".mnp-order-reject-exchange-items .RejectDetailContent").val())return e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[],a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"reject_exchange",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),reject_detail_content:a(".mnp-order-reject-exchange-items .RejectDetailContent").val()},"교환 요청을 거부 처리 했습니다."),!1;alert("교환 거부 사유를 입력해주세요.")},redelivery_exchange:function(){var e=a("#mnp-naverpay-order").find(".check-column input:checked"),r=[];return a(e).each(function(){var e=a(this).closest("tr");e.attr("data-product_order_id")&&r.push(e.attr("data-product_order_id"))}),n.bulk_actions.do_naverpay_action(naverpay_admin_order.order_action,{command:"redelivery_exchange",order_id:naverpay_admin_order.order_id,product_order_id:r.join(","),redelivery_method_code:a(".mnp-order-redelivery-exchange-items select.ReDeliveryMethodCode").val(),redelivery_company_code:a(".mnp-order-redelivery-exchange-items select.ReDeliveryCompanyCode").val(),redelivery_tracking_number:a(".mnp-order-redelivery-exchange-items .ReDeliveryTrackingNumber").val()},"상품 주문을 재발송 처리했습니다."),!1}},backbone:{init:function(e,r){"#wc-modal-add-products"===r&&a("body").trigger("wc-enhanced-select-init")},response:function(e,r,o){var n,a;"#wc-modal-add-tax"===r&&(n=o.add_order_tax,a="",o.manual_tax_rate_id&&(a=o.manual_tax_rate_id),wc_meta_boxes_order_items.backbone.add_tax(n,a)),"#wc-modal-add-products"===r&&wc_meta_boxes_order_items.backbone.add_item(o.add_order_items)},add_item:function(e){var o;(e=e.split(","))&&(o=e.length,wc_meta_boxes_order_items.block(),a.each(e,function(e,r){r={action:"woocommerce_add_order_item",item_to_add:r,order_id:woocommerce_admin_meta_boxes.post_id,security:woocommerce_admin_meta_boxes.order_item_nonce};a.post(woocommerce_admin_meta_boxes.ajax_url,r,function(e){a("table.woocommerce_order_items tbody#order_line_items").append(e),--o||(wc_meta_boxes_order.init_tiptip(),wc_meta_boxes_order_items.unblock())})}))},add_tax:function(e,r){if(!(e=r?r:e))return!1;var r=a(".order-tax-id").map(function(){return a(this).val()}).get();-1===a.inArray(e,r)?(wc_meta_boxes_order_items.block(),r={action:"woocommerce_add_order_tax",rate_id:e,order_id:woocommerce_admin_meta_boxes.post_id,security:woocommerce_admin_meta_boxes.order_item_nonce},a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:r,type:"POST",success:function(e){a("#woocommerce-order-items .inside").empty(),a("#woocommerce-order-items .inside").append(e),wc_meta_boxes_order.init_tiptip(),wc_meta_boxes_order_items.unblock(),wc_meta_boxes_order_items.stupidtable.init()}})):window.alert(woocommerce_admin_meta_boxes.i18n_tax_rate_already_exists)}}};n.init(),a(".nmp-order-detail-info").on("click",function(){return"table-row"===a(this).closest("tr").find("+tr").css("display")?a(this).closest("tr").find("+tr").css("display","none"):a(this).closest("tr").find("+tr").css("display","table-row"),!1})});